<!DOCTYPE html>
<html lang="bs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kviz 1D - HARD</title>
    
    <!-- Osnovni CSS -->
    <link rel="stylesheet" href="../core/styles.css">
    <!-- Advanced CSS -->
    <link rel="stylesheet" href="../core/styles-advanced.css">
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="quiz-header">
            <img src="../assets/images/mekteb_logo.png" alt="MEKTEB Logo" class="quiz-icon">
            <h1>Kviz 1D - HARD</h1>
            <p class="subtitle">Sure i Dove - Napredni nivo</p>
        </div>

        <!-- QUIZ SCREEN -->
        <div id="quizScreen" class="quiz-screen">
            <div class="progress-info">
                <a href="../index.html" class="back-link">â† Nazad</a>
                <div class="progress-bar-container">
                    <div id="progressBar" class="progress-bar"></div>
                </div>
                <span id="questionCounter" style="color: #fbbf24; font-weight: 600;">1/20</span>
            </div>

            <div class="question-card">
                <div id="questionText" class="question-text"></div>
                <div id="optionsContainer" class="options"></div>
            </div>
        </div>

        <!-- RESULT SCREEN -->
        <div id="resultScreen" class="result-screen">
            <div class="result-card">
                <div id="resultEmoji" class="result-emoji">ğŸŒŸ</div>
                <div id="resultMessage" class="result-message">Izvrsno!</div>
                <div id="resultScore" class="result-score">0/20</div>
                <div id="resultPercentage" class="result-percentage">0% taÄnih odgovora</div>
                <button onclick="restartQuiz()" class="restart-btn">ğŸ”„ Ponovi kviz</button>
            </div>
        </div>
    </div>

    <!-- POPUP OVERLAY -->
    <div id="popupOverlay" class="popup-overlay">
        <div class="popup-content">
            <div id="popupIcon" class="popup-icon">âœ…</div>
            <div id="popupTitle" class="popup-title">TaÄno!</div>
            <div id="popupExplanation" class="popup-explanation"></div>
            <button onclick="nextQuestion()" class="popup-next-btn">SljedeÄ‡e pitanje â†’</button>
        </div>
    </div>

    <!-- QUIZ DATA -->
    <script>
        const quizData = {
            questionsToShow: 20,
            allQuestions: [
// CHECKBOX (13)
            {type:'checkbox',question:'Koje su glavne sure koje uÄimo?',options:['El-Fatiha','El-Ihlas','El-Felek','En-Nas','El-Bekara'],correct:['El-Fatiha','El-Ihlas','El-Felek','En-Nas'],explanation:'Glavne sure: El-Fatiha, El-Ihlas, El-Felek, En-Nas.'},
            {type:'checkbox',question:'Å ta je taÄno o El-Fatihi?',options:['Prva sura u Kur\'anu','UÄimo je u namazu','Ima 7 ajeta','Ima 10 ajeta','Najbolja dova'],correct:['Prva sura u Kur\'anu','UÄimo je u namazu','Ima 7 ajeta','Najbolja dova'],explanation:'El-Fatiha je prva sura, ima 7 ajeta, uÄimo je u namazu, najbolja je dova.'},
            {type:'checkbox',question:'Å ta je taÄno o El-Ihlasu?',options:['Govori o Allahovom jedinstvu','Vrijedi treÄ‡inu Kur\'ana','Ima 4 ajeta','Ima 6 ajeta','UÄimo je u namazu'],correct:['Govori o Allahovom jedinstvu','Vrijedi treÄ‡inu Kur\'ana','Ima 4 ajeta','UÄimo je u namazu'],explanation:'El-Ihlas govori o Allahovom jedinstvu, vrijedi 1/3 Kur\'ana, ima 4 ajeta.'},
            {type:'checkbox',question:'Koje su "zaÅ¡titnice"?',options:['El-Felek','En-Nas','El-Ihlas','El-Fatiha'],correct:['El-Felek','En-Nas'],explanation:'ZaÅ¡titnice su El-Felek i En-Nas.'},
            {type:'checkbox',question:'Koje dove uÄimo?',options:['Subhaneke','Rabbi jessir','Rabbi zidni ilma','Allahu rabbi','Hasbi rabbi'],correct:['Subhaneke','Rabbi jessir','Rabbi zidni ilma','Allahu rabbi','Hasbi rabbi'],explanation:'Sve navedene su dove koje uÄimo.'},
            {type:'checkbox',question:'Å ta uÄimo na poÄetku namaza?',options:['Subhaneke','Euzubillu','Bismillu','Fatihu','Tekbir'],correct:['Subhaneke','Euzubillu','Bismillu','Fatihu'],explanation:'Na poÄetku: Subhaneke, Euzubillu, Bismillu, Fatiha, Sura.'},
            {type:'checkbox',question:'Kada uÄimo Bismillu?',options:['Prije jela','Prije uÄenja','Na poÄetku svakog posla','Poslije namaza'],correct:['Prije jela','Prije uÄenja','Na poÄetku svakog posla'],explanation:'Bismillu uÄimo prije jela, uÄenja i na poÄetku svakog posla.'},
            {type:'checkbox',question:'Å ta znaÄi El-Fatiha?',options:['OtvaraÄ','PoÄetak','Prva','ZakljuÄak'],correct:['OtvaraÄ','PoÄetak','Prva'],explanation:'El-Fatiha znaÄi: otvaraÄ, poÄetak, prva.'},
            {type:'checkbox',question:'Å ta znaÄi El-Ihlas?',options:['Iskrenost','ÄŒistoÄ‡a','Jedinstvo','ZaÅ¡tita'],correct:['Iskrenost','ÄŒistoÄ‡a'],explanation:'El-Ihlas znaÄi: iskrenost, ÄistoÄ‡a.'},
            {type:'checkbox',question:'Å ta znaÄi Subhaneke?',options:['Slava Tebi Allahu','Hvala Tebi','Blagoslovljen Si','VeliÄina Ti je nedostiÅ¾na'],correct:['Slava Tebi Allahu','Hvala Tebi','Blagoslovljen Si','VeliÄina Ti je nedostiÅ¾na'],explanation:'Subhaneke: slava, hvala, blagoslov, veliÄina.'},
            {type:'checkbox',question:'Kada uÄimo Euzubillu?',options:['Prije uÄenja Kur\'ana','Prije namaza','Prije jela','Na poÄetku svakog posla'],correct:['Prije uÄenja Kur\'ana','Prije namaza'],explanation:'Euzubillu uÄimo prije Kur\'ana i na poÄetku namaza.'},
            {type:'checkbox',question:'Å ta je taÄno o zaÅ¡titnicama?',options:['UÄimo ih ujutro i naveÄer','Å tite od zla','Tri puta ih uÄimo','Jednom dnevno'],correct:['UÄimo ih ujutro i naveÄer','Å tite od zla','Tri puta ih uÄimo'],explanation:'ZaÅ¡titnice uÄimo ujutro i naveÄer, 3 puta, za zaÅ¡titu od zla.'},
            {type:'checkbox',question:'Koja sura poÄinje sa "Kul"?',options:['El-Ihlas','El-Felek','En-Nas','El-Fatiha'],correct:['El-Ihlas','El-Felek','En-Nas'],explanation:'El-Ihlas, El-Felek i En-Nas poÄinju sa "Kul" (Reci).'},

            // REORDER (13)
            {type:'reorder',question:'Poredaj Subhaneke (dio):',items:[{text:'Subhaneke Allahumme',order:1},{text:'ve bihamdike',order:2},{text:'ve tebarekesmuke',order:3},{text:'ve te\'ala dÅ¾edduke',order:4}],explanation:'Subhaneke po redu.'},
            {type:'reorder',question:'Poredaj El-Fatihu (poÄetak):',items:[{text:'Bismillahir-Rahmanir-Rahim',order:1},{text:'El-hamdu lillahi rabbil-\'alemin',order:2},{text:'Er-Rahmanir-Rahim',order:3},{text:'Maliki jevmid-din',order:4}],explanation:'PoÄetak El-Fatihe.'},
            {type:'reorder',question:'Poredaj El-Ihlas:',items:[{text:'Kul huvallahu ehad',order:1},{text:'Allabus-Samed',order:2},{text:'Lem jelid ve lem juled',order:3},{text:'Ve lem jekul-lehu kufuven ehad',order:4}],explanation:'El-Ihlas po redu.'},
            {type:'reorder',question:'Poredaj Rabbi jessir:',items:[{text:'Rabbi jessir',order:1},{text:'ve la tu\'assir',order:2},{text:'Rabbi temmim',order:3},{text:'bil-hajr!',order:4}],explanation:'Rabbi jessir po redu.'},
            {type:'reorder',question:'Poredaj Allahu rabbi:',items:[{text:'Allahu rabbi',order:1},{text:'ve Muhammeden nebijji',order:2},{text:'vel-Kur\'anu kitabi',order:3},{text:'vel-islamu dini',order:4}],explanation:'Allahu rabbi po redu.'},
            {type:'reorder',question:'Poredaj prvo stajanje:',items:[{text:'Subhaneke',order:1},{text:'Euzubillu',order:2},{text:'Bismillu',order:3},{text:'Fatiha',order:4},{text:'Sura',order:5}],explanation:'Prvo stajanje u namazu.'},
            {type:'reorder',question:'Poredaj El-Felek (poÄetak):',items:[{text:'Kul e\'uzu birabbil-felek',order:1},{text:'Min Å¡erri ma halak',order:2},{text:'Ve min Å¡erri gasik-in iza vekab',order:3}],explanation:'PoÄetak El-Feleka.'},
            {type:'reorder',question:'Poredaj En-Nas (poÄetak):',items:[{text:'Kul e\'uzu birabbin-nas',order:1},{text:'Melikin-nas',order:2},{text:'Ilahin-nas',order:3}],explanation:'PoÄetak En-Nasa.'},
            {type:'reorder',question:'Poredaj Hasbi rabbi (dio):',items:[{text:'Hasbi rabbi',order:1},{text:'dÅ¾ellallahu',order:2},{text:'La ilahe illa huve',order:3},{text:'\'alejhi tevelkeltu',order:4}],explanation:'Hasbi rabbi po redu.'},
            {type:'reorder',question:'Poredaj Rabbi zidni ilma:',items:[{text:'Rabbi',order:1},{text:'zidni',order:2},{text:'\'ilma',order:3}],explanation:'Rabbi zidni \'ilma.'},
            {type:'reorder',question:'Poredaj prije jela:',items:[{text:'Bismillu',order:1},{text:'Jesti desnom rukom',order:2},{text:'El-hamdulillah (poslije)',order:3}],explanation:'Redoslijed pri jelu.'},
            {type:'reorder',question:'Poredaj Euzubillu i Bismillu:',items:[{text:'E\'uzu billahi mineÅ¡-Å¡ejtanir-radÅ¾im',order:1},{text:'Bismillahir-Rahmanir-Rahim',order:2}],explanation:'Prvo Euzubillu, pa Bismillu.'},
            {type:'reorder',question:'Poredaj sure po vaÅ¾nosti:',items:[{text:'El-Fatiha (najbolja dova)',order:1},{text:'El-Ihlas (1/3 Kur\'ana)',order:2},{text:'ZaÅ¡titnice (zaÅ¡tita)',order:3}],explanation:'Hijerarhija vaÅ¾nosti sura.'},

            // MARK WORDS (13)
            {type:'markWords',question:'PronaÄ‘i greÅ¡ke:',text:'El-Fatiha je druga sura u Kur\'anu i ima 10 ajeta.',words:['El-Fatiha','je','druga','sura','u','Kur\'anu','i','ima','10','ajeta.'],incorrect:[2,8],explanation:'El-Fatiha je PRVA sura (ne druga) i ima 7 ajeta (ne 10).'},
            {type:'markWords',question:'PronaÄ‘i greÅ¡ke:',text:'El-Ihlas ima 6 ajeta i vrijedi polovinu Kur\'ana.',words:['El-Ihlas','ima','6','ajeta','i','vrijedi','polovinu','Kur\'ana.'],incorrect:[2,6],explanation:'El-Ihlas ima 4 ajeta (ne 6) i vrijedi TREÄ†INU Kur\'ana (ne polovinu).'},
            {type:'markWords',question:'PronaÄ‘i greÅ¡ke:',text:'ZaÅ¡titnice su El-Ihlas i El-Fatiha koje uÄimo ujutro.',words:['ZaÅ¡titnice','su','El-Ihlas','i','El-Fatiha','koje','uÄimo','ujutro.'],incorrect:[2,4],explanation:'ZaÅ¡titnice su El-FELEK i En-NAS (ne El-Ihlas i El-Fatiha).'},
            {type:'markWords',question:'PronaÄ‘i greÅ¡ke:',text:'Subhaneke uÄimo poslije namaza i prije jela.',words:['Subhaneke','uÄimo','poslije','namaza','i','prije','jela.'],incorrect:[2,5,6],explanation:'Subhaneke uÄimo NA POÄŒETKU namaza (ne poslije, ne prije jela).'},
            {type:'markWords',question:'PronaÄ‘i greÅ¡ke:',text:'Rabbi jessir znaÄi: Gospodaru, oteÅ¾aj a ne olakÅ¡aj.',words:['Rabbi','jessir','znaÄi:','Gospodaru,','oteÅ¾aj','a','ne','olakÅ¡aj.'],incorrect:[4,7],explanation:'Rabbi jessir: OLAKÅ AJ (ne oteÅ¾aj) a ne OTEÅ½AJ (ne olakÅ¡aj).'},
            {type:'markWords',question:'PronaÄ‘i greÅ¡ke:',text:'El-Fatiha znaÄi zakljuÄak i uÄimo je poslije namaza.',words:['El-Fatiha','znaÄi','zakljuÄak','i','uÄimo','je','poslije','namaza.'],incorrect:[2,6],explanation:'El-Fatiha znaÄi OTVARAÄŒ/POÄŒETAK (ne zakljuÄak), uÄimo je U namazu (ne poslije).'},
            {type:'markWords',question:'PronaÄ‘i greÅ¡ke:',text:'Bismillu uÄimo samo prije jela, a Euzubillu prije spavanja.',words:['Bismillu','uÄimo','samo','prije','jela,','a','Euzubillu','prije','spavanja.'],incorrect:[2,7,8],explanation:'Bismillu uÄimo prije SVAKOG posla (ne samo jela), Euzubillu prije KUR\'ANA/namaza (ne spavanja).'},
            {type:'markWords',question:'PronaÄ‘i greÅ¡ke:',text:'El-Ihlas govori o Poslaniku a.s. i ima 7 ajeta.',words:['El-Ihlas','govori','o','Poslaniku','a.s.','i','ima','7','ajeta.'],incorrect:[3,4,7],explanation:'El-Ihlas govori o ALLAHOVOM JEDINSTVU (ne Poslaniku) i ima 4 ajeta (ne 7).'},
            {type:'markWords',question:'PronaÄ‘i greÅ¡ke:',text:'ZaÅ¡titnice uÄimo jednom dnevno, samo ujutro.',words:['ZaÅ¡titnice','uÄimo','jednom','dnevno,','samo','ujutro.'],incorrect:[2,4],explanation:'ZaÅ¡titnice uÄimo UJUTRO I NAVEÄŒER (ne jednom), TRI PUTA (ne samo ujutro).'},
            {type:'markWords',question:'PronaÄ‘i greÅ¡ke:',text:'Rabbi zidni ilma znaÄi: Gospodaru, smanji moje znanje.',words:['Rabbi','zidni','ilma','znaÄi:','Gospodaru,','smanji','moje','znanje.'],incorrect:[5],explanation:'Rabbi zidni ilma: PROÅ IRI (ne smanji) znanje.'},
            {type:'markWords',question:'PronaÄ‘i greÅ¡ke:',text:'Allahu rabbi znaÄi: Muhammed moj poslanik i Kur\'an moj Å¾ivot.',words:['Allahu','rabbi','znaÄi:','Muhammed','moj','poslanik','i','Kur\'an','moj','Å¾ivot.'],incorrect:[3,4,9],explanation:'Allahu rabbi znaÄi: ALLAH moj Gospodar (ne Muhammed), Kur\'an moj KITAB (ne Å¾ivot).'},
            {type:'markWords',question:'PronaÄ‘i greÅ¡ke:',text:'Prvo stajanje: Fatiha, Subhaneke, Bismillu, Euzubillu, Sura.',words:['Prvo','stajanje:','Fatiha,','Subhaneke,','Bismillu,','Euzubillu,','Sura.'],incorrect:[2,3,4,5],explanation:'Redoslijed: Subhaneke, Euzubillu, Bismillu, Fatiha, Sura.'},
            {type:'markWords',question:'PronaÄ‘i greÅ¡ke:',text:'Hasbi rabbi znaÄi: Meni je dovoljan Poslanik a.s.',words:['Hasbi','rabbi','znaÄi:','Meni','je','dovoljan','Poslanik','a.s.'],incorrect:[6,7],explanation:'Hasbi rabbi: dovoljan UZVIÅ ENI ALLAH (ne Poslanik).'},

            // DRAG DROP (13)
            {type:'dragDrop',question:'Dopuni El-Fatihu:',template:['El-Fatiha je','DROP','sura u Kur\'anu i ima','DROP','ajeta'],words:['prva','7','druga','10'],correct:['prva','7'],explanation:'El-Fatiha je prva sura, ima 7 ajeta.'},
            {type:'dragDrop',question:'Dopuni El-Ihlas:',template:['El-Ihlas ima','DROP','ajeta i vrijedi','DROP','Kur\'ana'],words:['4','treÄ‡inu','6','polovinu'],correct:['4','treÄ‡inu'],explanation:'El-Ihlas: 4 ajeta, treÄ‡ina Kur\'ana.'},
            {type:'dragDrop',question:'Dopuni zaÅ¡titnice:',template:['ZaÅ¡titnice su','DROP','i','DROP'],words:['El-Felek','En-Nas','El-Ihlas','El-Fatiha'],correct:['El-Felek','En-Nas'],explanation:'ZaÅ¡titnice: El-Felek i En-Nas.'},
            {type:'dragDrop',question:'Dopuni Subhaneke:',template:['Subhaneke uÄimo na','DROP','namaza i znaÄi','DROP'],words:['poÄetku','slava Tebi','kraju','hvala Allahu'],correct:['poÄetku','slava Tebi'],explanation:'Subhaneke: poÄetak namaza, slava Tebi Allahu.'},
            {type:'dragDrop',question:'Dopuni Rabbi jessir:',template:['Rabbi jessir:','DROP','a ne oteÅ¾aj, dovrÅ¡i sa','DROP'],words:['olakÅ¡aj','dobrom','oteÅ¾aj','zlom'],correct:['olakÅ¡aj','dobrom'],explanation:'Rabbi jessir: olakÅ¡aj, dovrÅ¡i sa dobrom.'},
            {type:'dragDrop',question:'Dopuni Rabbi zidni ilma:',template:['Rabbi','DROP','\'ilma znaÄi:','DROP','moje proÅ¡iri'],words:['zidni','znanje','jessir','snagu'],correct:['zidni','znanje'],explanation:'Rabbi zidni \'ilma: znanje moje proÅ¡iri.'},
            {type:'dragDrop',question:'Dopuni Bismillu:',template:['Bismillu uÄimo','DROP','jela i na poÄetku','DROP'],words:['prije','svakog posla','poslije','namaza'],correct:['prije','svakog posla'],explanation:'Bismillu: prije jela i prije svakog posla.'},
            {type:'dragDrop',question:'Dopuni Euzubillu:',template:['Euzubillu uÄimo prije','DROP','i na poÄetku','DROP'],words:['Kur\'ana','namaza','jela','spavanja'],correct:['Kur\'ana','namaza'],explanation:'Euzubillu: prije Kur\'ana i na poÄetku namaza.'},
            {type:'dragDrop',question:'Dopuni Allahu rabbi:',template:['Allahu','DROP','ve Muhammeden','DROP'],words:['rabbi','nebijji','ilahi','resulullah'],correct:['rabbi','nebijji'],explanation:'Allahu rabbi ve Muhammeden nebijji.'},
            {type:'dragDrop',question:'Dopuni prvo stajanje:',template:['Prvo: Subhaneke,','DROP','pa Bismillu, pa','DROP'],words:['Euzubillu,','Fatiha','Tekbir,','Sura'],correct:['Euzubillu,','Fatiha'],explanation:'Redoslijed: Subhaneke, Euzubillu, Bismillu, Fatiha, Sura.'},
            {type:'dragDrop',question:'Dopuni El-Ihlas:',template:['El-Ihlas govori o','DROP','i poÄinje sa','DROP'],words:['Allahovom jedinstvu','Kul','Poslaniku a.s.','Bismillah'],correct:['Allahovom jedinstvu','Kul'],explanation:'El-Ihlas: Allahovo jedinstvo, poÄinje "Kul".'},
            {type:'dragDrop',question:'Dopuni zaÅ¡titnice kada:',template:['ZaÅ¡titnice uÄimo','DROP','i naveÄer,','DROP','puta'],words:['ujutro','tri','podne','pet'],correct:['ujutro','tri'],explanation:'ZaÅ¡titnice: ujutro i naveÄer, 3 puta.'},
            {type:'dragDrop',question:'Dopuni Hasbi rabbi:',template:['Hasbi rabbi znaÄi: Dovoljan mi je','DROP','U mom srcu je samo','DROP'],words:['uzviÅ¡eni Allah','Allah','Poslanik','iman'],correct:['uzviÅ¡eni Allah','Allah'],explanation:'Hasbi rabbi: dovoljan uzviÅ¡eni Allah, u srcu Allah.'}
            ]
        };
    </script>

    <!-- Advanced JavaScript Engine -->
    <script src="../core/quiz-engine-advanced.js"></script>
    <!-- MEKTEB AUTO-SAVE - Inline integracija -->
    <script>
    console.log('ğŸ”Œ MEKTEB AUTO-SAVE: UÄitan!');
    
    // ÄŒekaj da se stranica potpuno uÄita
    window.addEventListener('load', function() {
        console.log('ğŸ“„ Stranica uÄitana, aktiviram auto-save...');
        
        // Funkcija za spremanje rezultata
        async function saveMektebResult(score, total, time) {
            const API_URL = 'https://mekteb.net/wp-json/mekteb/v1';
            
            console.log('ğŸ’¾ saveMektebResult pozvan:', {score, total, time});
            
            // Provjeri da li je korisnik prijavljen
            const userData = localStorage.getItem('mektebUser');
            if (!userData) {
                console.log('âš ï¸ Korisnik nije prijavljen - preskaÄem spremanje');
                return false;
            }
            
            let user;
            try {
                user = JSON.parse(userData);
                console.log('ğŸ‘¤ Prijavljen korisnik:', user.name, '(ID:', user.id + ')');
            } catch (e) {
                console.error('âŒ GreÅ¡ka pri parsiranju user podataka:', e);
                return false;
            }
            
            // Detektuj naziv kviza iz URL-a
            const quizName = window.location.pathname.match(/\/([^\/]+)\.html$/)?.[1]?.toUpperCase() || 'UNKNOWN';
            console.log('ğŸ“ Kviz:', quizName);
            
            const payload = {
                user_id: user.id,
                quiz: quizName,
                score: score,
                total: total,
                time: time || 0
            };
            
            console.log('ğŸ“¤ Å aljem na API:', payload);
            
            try {
                const response = await fetch(API_URL + '/save', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });
                
                console.log('ğŸ“¥ API Response Status:', response.status);
                
                const data = await response.json();
                console.log('ğŸ“¦ API Response Data:', data);
                
                if (data.success) {
                    console.log('âœ… REZULTAT USPJEÅ NO SPREMLJEN!');
                    console.log('   User:', user.name);
                    console.log('   Kviz:', quizName);
                    console.log('   Rezultat:', score + '/' + total);
                    console.log('   Postotak:', Math.round((score/total)*100) + '%');
                    return true;
                } else {
                    console.error('âŒ API vratio greÅ¡ku:', data.message);
                    return false;
                }
            } catch (error) {
                console.error('ğŸ”¥ GreÅ¡ka pri slanju na API:', error);
                return false;
            }
        }
        
        // Javna funkcija za ruÄno spremanje
        window.mektebSave = saveMektebResult;
        
        // AUTOMATSKO DETEKTOVANJE REZULTATA
        let resultSaved = false;
        let lastSeenScore = '0/20';
        
        const observer = new MutationObserver(function(mutations) {
            const resultScreen = document.getElementById('resultScreen');
            const resultScore = document.getElementById('resultScore');
            
            if (resultScreen && resultScore && 
                resultScreen.style.display !== 'none' && 
                !resultSaved) {
                
                const scoreText = resultScore.textContent;
                
                // Ako se rezultat promijenio i nije 0/20
                if (scoreText !== lastSeenScore && scoreText !== '0/20') {
                    console.log('ğŸ¯ Rezultat se promijenio:', lastSeenScore, 'â†’', scoreText);
                    
                    const match = scoreText.match(/(\d+)\/(\d+)/);
                    if (match) {
                        const score = parseInt(match[1]);
                        const total = parseInt(match[2]);
                        
                        // Validacija: score mora biti > 0 ili ako je stvarno 0 onda total > 0
                        if (score > 0 || (score === 0 && total > 0 && scoreText !== '0/20')) {
                            console.log('âœ… Detektovan finalni rezultat:', score + '/' + total);
                            
                            resultSaved = true;
                            saveMektebResult(score, total, 0);
                        }
                    }
                }
                
                lastSeenScore = scoreText;
            }
        });
        
        // Posmatraj cijeli body
        observer.observe(document.body, {
            childList: true,
            subtree: true,
            attributes: true,
            attributeFilter: ['style'],
            characterData: true  // Prati promjene u tekstualnom sadrÅ¾aju
        });
        
        console.log('âœ… Auto-save modul aktivan!');
        console.log('   ğŸ“Œ Za ruÄno spremanje: window.mektebSave(score, total, time)');
    });
    </script>
</body>
</html>