<!DOCTYPE html>
<html lang="bs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kviz 1C - HARD</title>
    
    <!-- Osnovni CSS -->
    <link rel="stylesheet" href="../core/styles.css">
    <!-- Advanced CSS -->
    <link rel="stylesheet" href="../core/styles-advanced.css">
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="quiz-header">
            <img src="../assets/images/mekteb_logo.png" alt="MEKTEB Logo" class="quiz-icon">
            <h1>Kviz 1C - HARD</h1>
            <p class="subtitle">Dove, Bajrami, Hid≈æra - Napredni nivo</p>
        </div>

        <!-- QUIZ SCREEN -->
        <div id="quizScreen" class="quiz-screen">
            <div class="progress-info">
                <a href="../index.html" class="back-link">‚Üê Nazad</a>
                <div class="progress-bar-container">
                    <div id="progressBar" class="progress-bar"></div>
                </div>
                <span id="questionCounter" style="color: #fbbf24; font-weight: 600;">1/20</span>
            </div>

            <div class="question-card">
                <div id="questionText" class="question-text"></div>
                <div id="optionsContainer" class="options"></div>
            </div>
        </div>

        <!-- RESULT SCREEN -->
        <div id="resultScreen" class="result-screen">
            <div class="result-card">
                <div id="resultEmoji" class="result-emoji">üåü</div>
                <div id="resultMessage" class="result-message">Izvrsno!</div>
                <div id="resultScore" class="result-score">0/20</div>
                <div id="resultPercentage" class="result-percentage">0% taƒçnih odgovora</div>
                <button onclick="restartQuiz()" class="restart-btn">üîÑ Ponovi kviz</button>
            </div>
        </div>
    </div>

    <!-- POPUP OVERLAY -->
    <div id="popupOverlay" class="popup-overlay">
        <div class="popup-content">
            <div id="popupIcon" class="popup-icon">‚úÖ</div>
            <div id="popupTitle" class="popup-title">Taƒçno!</div>
            <div id="popupExplanation" class="popup-explanation"></div>
            <button onclick="nextQuestion()" class="popup-next-btn">Sljedeƒáe pitanje ‚Üí</button>
        </div>
    </div>

    <!-- QUIZ DATA -->
    <script>
        const quizData = {
            questionsToShow: 20,
            allQuestions: [
// CHECKBOX (13)
            {type:'checkbox',question:'Koje dove uƒçimo?',options:['Rabbi jessir','Rabbi zidni ilma','Allahu rabbi','Hasbi rabbi','Kelime-i ≈°ehadet'],correct:['Rabbi jessir','Rabbi zidni ilma','Allahu rabbi','Hasbi rabbi'],explanation:'Sve navedene su dove osim Kelime-i ≈°ehadeta koja je svjedoƒçenje vjere.'},
            {type:'checkbox',question:'Koliko dana traju bajrami?',options:['Ramazanski 3 dana','Ramazanski 4 dana','Kurban 3 dana','Kurban 4 dana'],correct:['Ramazanski 3 dana','Kurban 4 dana'],explanation:'Ramazanski bajram traje 3 dana, Kurban-bajram traje 4 dana.'},
            {type:'checkbox',question:'≈†ta je taƒçno o Hid≈æri?',options:['Dogodila se 622. godine','Preselenje iz Mekke u Medinu','Preselenje iz Medine u Mekku','Od nje poƒçinje islamski kalendar'],correct:['Dogodila se 622. godine','Preselenje iz Mekke u Medinu','Od nje poƒçinje islamski kalendar'],explanation:'Hid≈æra je preselenje iz Mekke u Medinu 622. godine, od kada poƒçinje hid≈æretska godina.'},
            {type:'checkbox',question:'Koliko mjeseci ima hid≈æretska godina?',options:['10','11','12','13'],correct:['12'],explanation:'Hid≈æretska godina ima 12 mjeseci.'},
            {type:'checkbox',question:'Koji su mubarek-dani?',options:['Nova hid≈æretska godina','Mevlud','Ramazanski bajram','Kurban-bajram','D≈æenaza'],correct:['Nova hid≈æretska godina','Mevlud','Ramazanski bajram','Kurban-bajram'],explanation:'ƒåetiri glavna mubarek-dana su: Nova hid≈æretska godina, Mevlud, Ramazanski bajram i Kurban-bajram.'},
            {type:'checkbox',question:'Kada se obilje≈æava Ramazanski bajram?',options:['Poslije mjeseca ramazana','Prvi ≈°evvala','Poslije posta','Poslije had≈æa'],correct:['Poslije mjeseca ramazana','Prvi ≈°evvala','Poslije posta'],explanation:'Ramazanski bajram je prvi dan mjeseca ≈°evvala, poslije mjeseca ramazana i posta.'},
            {type:'checkbox',question:'Kada se obilje≈æava Kurban-bajram?',options:['Deseti zul-hid≈æea','Poslije had≈æa','Poslije posta','Traje 4 dana'],correct:['Deseti zul-hid≈æea','Poslije had≈æa','Traje 4 dana'],explanation:'Kurban-bajram poƒçinje 10. zul-hid≈æea, poslije had≈æa, i traje 4 dana.'},
            {type:'checkbox',question:'Kada je roƒëen Muhammed a.s.?',options:['12. rebiul-evvela','571. godine','U Mekki','U Medini'],correct:['12. rebiul-evvela','571. godine','U Mekki'],explanation:'Muhammed a.s. roƒëen je 12. rebiul-evvela 571. godine u Mekki.'},
            {type:'checkbox',question:'≈†ta uƒçimo na Kurban-bajram?',options:['Tekbirje','Allahu ekber','Fatihu','Salavate'],correct:['Tekbirje','Allahu ekber'],explanation:'Na Kurban-bajram uƒçimo tekbirje koji poƒçinju sa "Allahu ekber...".'},
            {type:'checkbox',question:'Prvi dan hid≈æretskog kalendara je:',options:['Petak','Subota','Nedjelja','Ponedjeljak'],correct:['Petak'],explanation:'Prvi dan sedmice hid≈æretskog kalendara je petak.'},
            {type:'checkbox',question:'Koliko dana traje hid≈æretska godina?',options:['355 dana','365 dana','354 dana','366 dana'],correct:['355 dana'],explanation:'Hid≈æretska (lunarna) godina ima 355 dana.'},
            {type:'checkbox',question:'≈†ta radimo na Ramazanski bajram?',options:['Klanjamo bajram-namaz','Idemo na mezarje','Uƒçimo Fatihu','Posjeƒáujemo rodbinu'],correct:['Klanjamo bajram-namaz','Idemo na mezarje','Uƒçimo Fatihu','Posjeƒáujemo rodbinu'],explanation:'Na Ramazanski bajram klanjamo bajram-namaz, idemo na mezarje, uƒçimo Fatihu i posjeƒáujemo rodbinu.'},
            {type:'checkbox',question:'≈†to znaƒçe ovi izrazi?',options:['Rabbi jessir - olak≈°aj','Rabbi zidni ilma - pro≈°iri znanje','Allahu rabbi - Allah moj Gospodar','Hasbi rabbi - moj uƒçitelj'],correct:['Rabbi jessir - olak≈°aj','Rabbi zidni ilma - pro≈°iri znanje','Allahu rabbi - Allah moj Gospodar'],explanation:'Rabbi jessir = olak≈°aj, Rabbi zidni ilma = pro≈°iri znanje, Allahu rabbi = Allah moj Gospodar.'},

            // REORDER (13)
            {type:'reorder',question:'Poredaj dovu Rabbi jessir:',items:[{text:'Rabbi jessir',order:1},{text:'ve la tu\'assir',order:2},{text:'Rabbi temmim',order:3},{text:'bil-hajr!',order:4}],explanation:'Rabbi jessir: Gospodaru olak≈°aj, a ne ote≈æaj, dovr≈°i sa dobrom!'},
            {type:'reorder',question:'Poredaj dovu Rabbi zidni ilma:',items:[{text:'Rabbi',order:1},{text:'zidni',order:2},{text:'\'ilma',order:3}],explanation:'Rabbi zidni \'ilma: Gospodaru moj, znanje moje pro≈°iri!'},
            {type:'reorder',question:'Poredaj prvih 6 mjeseci hid≈æretske godine:',items:[{text:'Muharrem',order:1},{text:'Safer',order:2},{text:'Rebiul-evvel',order:3},{text:'Rebiul-ahir',order:4},{text:'D≈æumadel-ula',order:5},{text:'D≈æumadel-uhra',order:6}],explanation:'Prvih 6 mjeseci hid≈æretske godine.'},
            {type:'reorder',question:'Poredaj drugih 6 mjeseci hid≈æretske godine:',items:[{text:'Red≈æeb',order:1},{text:'≈†a\'ban',order:2},{text:'Ramazan',order:3},{text:'≈†evval',order:4},{text:'Zul-kade',order:5},{text:'Zul-hid≈æe',order:6}],explanation:'Drugih 6 mjeseci hid≈æretske godine.'},
            {type:'reorder',question:'Poredaj 4 mubarek-dana:',items:[{text:'Nova hid≈æretska godina',order:1},{text:'Mevlud',order:2},{text:'Ramazanski bajram',order:3},{text:'Kurban-bajram',order:4}],explanation:'ƒåetiri glavna mubarek-dana po redu kroz hid≈æretsku godinu.'},
            {type:'reorder',question:'Poredaj tekbirje (dio):',items:[{text:'Allahu ekber',order:1},{text:'Allahu ekber',order:2},{text:'La ilahe illallahu',order:3},{text:'vallahu ekber',order:4}],explanation:'Tekbirje: Allahu ekber, Allahu ekber, La ilahe illallahu vallahu ekber...'},
            {type:'reorder',question:'Poredaj dovu Allahu rabbi:',items:[{text:'Allahu rabbi',order:1},{text:'ve Muhammeden nebijji',order:2},{text:'vel-Kur\'anu kitabi',order:3},{text:'vel-islamu dini',order:4}],explanation:'Allahu rabbi po redu.'},
            {type:'reorder',question:'Poredaj dogaƒëaje Hid≈ære:',items:[{text:'≈Ωivot u Mekki',order:1},{text:'Preselenje',order:2},{text:'Dolazak u Medinu',order:3},{text:'Poƒçetak hid≈æretske godine',order:4}],explanation:'Hronologija dogaƒëaja oko Hid≈ære.'},
            {type:'reorder',question:'Poredaj Hasbi rabbi:',items:[{text:'Hasbi rabbi',order:1},{text:'d≈æellallahu',order:2},{text:'La ilahe illa huve',order:3},{text:'\'alejhi tevekkeltlu',order:4}],explanation:'Dova Hasbi rabbi po redu.'},
            {type:'reorder',question:'Poredaj radnje na Ramazanski bajram:',items:[{text:'Ujutro pojesti ne≈°to',order:1},{text:'Otiƒái u d≈æamiju',order:2},{text:'Klanjati bajram-namaz',order:3},{text:'Iƒái na mezarje',order:4}],explanation:'Redoslijed radnji na Ramazanski bajram.'},
            {type:'reorder',question:'Poredaj dane Ramazanskog bajrama:',items:[{text:'Prvi dan - bajram-namaz',order:1},{text:'Drugi dan - mezarje',order:2},{text:'Treƒái dan - posjete',order:3}],explanation:'Tri dana Ramazanskog bajrama.'},
            {type:'reorder',question:'Poredaj dane Kurban-bajrama:',items:[{text:'Prvi dan - bajram-namaz',order:1},{text:'Drugi dan - kurban',order:2},{text:'Treƒái dan - kurban',order:3},{text:'ƒåetvrti dan - kurban',order:4}],explanation:'ƒåetiri dana Kurban-bajrama.'},
            {type:'reorder',question:'Poredaj roƒëenje Muhammeda a.s.:',items:[{text:'Godina 571.',order:1},{text:'Mjesec rebiul-evvel',order:2},{text:'Dan 12.',order:3},{text:'Grad Mekka',order:4}],explanation:'Podaci o roƒëenju Muhammeda a.s.'},

            // MARK WORDS (13)
            {type:'markWords',question:'Pronaƒëi gre≈°ke:',text:'Ramazanski bajram traje 4 dana, a Kurban-bajram traje 3 dana.',words:['Ramazanski','bajram','traje','4','dana,','a','Kurban-bajram','traje','3','dana.'],incorrect:[3,8],explanation:'Ramazanski traje 3 dana (ne 4), Kurban traje 4 dana (ne 3).'},
            {type:'markWords',question:'Pronaƒëi gre≈°ke:',text:'Hid≈æra se dogodila 632. godine. To je preselenje iz Medine u Mekku.',words:['Hid≈æra','se','dogodila','632.','godine.','To','je','preselenje','iz','Medine','u','Mekku.'],incorrect:[3,9,11],explanation:'Hid≈æra je 622. godine (ne 632), iz MEKKE (ne Medine) u MEDINU (ne Mekku).'},
            {type:'markWords',question:'Pronaƒëi gre≈°ke:',text:'Hid≈æretska godina ima 10 mjeseci i 365 dana.',words:['Hid≈æretska','godina','ima','10','mjeseci','i','365','dana.'],incorrect:[3,6],explanation:'Hid≈æretska godina ima 12 mjeseci (ne 10) i 355 dana (ne 365).'},
            {type:'markWords',question:'Pronaƒëi gre≈°ke:',text:'Muhammed a.s. roƒëen je 10. muharrema 571. godine u Medini.',words:['Muhammed','a.s.','roƒëen','je','10.','muharrema','571.','godine','u','Medini.'],incorrect:[4,5,9],explanation:'Muhammed a.s. roƒëen je 12. REBIUL-EVVELA (ne 10. muharrema) u MEKKI (ne Medini).'},
            {type:'markWords',question:'Pronaƒëi gre≈°ke:',text:'Ramazanski bajram je 10. ≈°evvala, poslije mjeseca ramazana.',words:['Ramazanski','bajram','je','10.','≈°evvala,','poslije','mjeseca','ramazana.'],incorrect:[3],explanation:'Ramazanski bajram je 1. ≈°evvala (ne 10.).'},
            {type:'markWords',question:'Pronaƒëi gre≈°ke:',text:'Kurban-bajram je 1. zul-hid≈æea i traje 3 dana.',words:['Kurban-bajram','je','1.','zul-hid≈æea','i','traje','3','dana.'],incorrect:[2,6],explanation:'Kurban-bajram je 10. zul-hid≈æea (ne 1.) i traje 4 dana (ne 3).'},
            {type:'markWords',question:'Pronaƒëi gre≈°ke:',text:'Prvi dan hid≈æretskog kalendara je subota. Godina ima 400 dana.',words:['Prvi','dan','hid≈æretskog','kalendara','je','subota.','Godina','ima','400','dana.'],incorrect:[5,8],explanation:'Prvi dan je PETAK (ne subota), godina ima 355 dana (ne 400).'},
            {type:'markWords',question:'Pronaƒëi gre≈°ke:',text:'Mubarek-dana ima tri: Mevlud, Ramazanski bajram i Hid≈æra.',words:['Mubarek-dana','ima','tri:','Mevlud,','Ramazanski','bajram','i','Hid≈æra.'],incorrect:[2,7],explanation:'Mubarek-dana ima 4 (ne tri): Nova hid≈æretska godina, Mevlud, Ramazanski bajram, Kurban-bajram. Hid≈æra nije mubarek-dan.'},
            {type:'markWords',question:'Pronaƒëi gre≈°ke:',text:'Rabbi jessir znaƒçi: Gospodaru, ote≈æaj a ne olak≈°aj!',words:['Rabbi','jessir','znaƒçi:','Gospodaru,','ote≈æaj','a','ne','olak≈°aj!'],incorrect:[4,7],explanation:'Rabbi jessir znaƒçi: Gospodaru, OLAK≈†AJ (ne ote≈æaj) a ne OTE≈ΩAJ (ne olak≈°aj)!'},
            {type:'markWords',question:'Pronaƒëi gre≈°ke:',text:'Rabbi zidni ilma znaƒçi: Gospodaru, smanji moje znanje!',words:['Rabbi','zidni','ilma','znaƒçi:','Gospodaru,','smanji','moje','znanje!'],incorrect:[5],explanation:'Rabbi zidni ilma znaƒçi: Gospodaru, PRO≈†IRI (ne smanji) moje znanje!'},
            {type:'markWords',question:'Pronaƒëi gre≈°ke:',text:'Na Ramazanski bajram klanjamo d≈æenaza-namaz u d≈æamiji.',words:['Na','Ramazanski','bajram','klanjamo','d≈æenaza-namaz','u','d≈æamiji.'],incorrect:[4],explanation:'Klanjamo BAJRAM-NAMAZ (ne d≈æenaza-namaz).'},
            {type:'markWords',question:'Pronaƒëi gre≈°ke:',text:'Tekbirje uƒçimo na Ramazanski bajram tokom sva 3 dana.',words:['Tekbirje','uƒçimo','na','Ramazanski','bajram','tokom','sva','3','dana.'],incorrect:[3,4],explanation:'Tekbirje uƒçimo na KURBAN-bajram (ne Ramazanski) tokom sva 4 dana.'},
            {type:'markWords',question:'Pronaƒëi gre≈°ke:',text:'Allahu rabbi znaƒçi: Allah je veliki i moƒáan uvijek.',words:['Allahu','rabbi','znaƒçi:','Allah','je','veliki','i','moƒáan','uvijek.'],incorrect:[5,6,7,8],explanation:'Allahu rabbi znaƒçi: Allah moj Gospodar (ne "je veliki i moƒáan uvijek").'},

            // DRAG DROP (13)
            {type:'dragDrop',question:'Dopuni bajrame:',template:['Ramazanski bajram traje','DROP','dana, Kurban-bajram traje','DROP','dana'],words:['3','4','2','5'],correct:['3','4'],explanation:'Ramazanski 3 dana, Kurban 4 dana.'},
            {type:'dragDrop',question:'Dopuni Hid≈æru:',template:['Hid≈æra se dogodila','DROP','godine, preselenje iz','DROP','u Medinu'],words:['622.','Mekke','632.','Medine'],correct:['622.','Mekke'],explanation:'Hid≈æra 622. godine iz Mekke u Medinu.'},
            {type:'dragDrop',question:'Dopuni hid≈æretsku godinu:',template:['Hid≈æretska godina ima','DROP','mjeseci i','DROP','dana'],words:['12','355','10','365'],correct:['12','355'],explanation:'Hid≈æretska godina: 12 mjeseci, 355 dana.'},
            {type:'dragDrop',question:'Dopuni Mevlud:',template:['Muhammed a.s. roƒëen','DROP','rebiul-evvela','DROP','godine'],words:['12.','571.','10.','622.'],correct:['12.','571.'],explanation:'Muhammed a.s. roƒëen 12. rebiul-evvela 571. godine.'},
            {type:'dragDrop',question:'Dopuni Rabbi jessir:',template:['Rabbi jessir ve la','DROP','Rabbi temmim','DROP'],words:['tu\'assir,','bil-hajr!','tu\'alim,','bil-ilm!'],correct:['tu\'assir,','bil-hajr!'],explanation:'Rabbi jessir: olak≈°aj a ne ote≈æaj, dovr≈°i sa dobrom!'},
            {type:'dragDrop',question:'Dopuni Rabbi zidni ilma:',template:['Rabbi','DROP','\'ilma - Gospodaru,','DROP','moje pro≈°iri'],words:['zidni','znanje','jessir','dobro'],correct:['zidni','znanje'],explanation:'Rabbi zidni \'ilma: Gospodaru, znanje moje pro≈°iri!'},
            {type:'dragDrop',question:'Dopuni Ramazanski bajram:',template:['Ramazanski bajram je','DROP','dan mjeseca','DROP'],words:['prvi','≈°evvala','deseti','ramazana'],correct:['prvi','≈°evvala'],explanation:'Ramazanski bajram: 1. ≈°evvala.'},
            {type:'dragDrop',question:'Dopuni Kurban-bajram:',template:['Kurban-bajram je','DROP','dan mjeseca','DROP'],words:['deseti','zul-hid≈æea','prvi','≈°evvala'],correct:['deseti','zul-hid≈æea'],explanation:'Kurban-bajram: 10. zul-hid≈æea.'},
            {type:'dragDrop',question:'Dopuni broj mubarek-dana:',template:['Mubarek-dana ima','DROP','Prvi je','DROP'],words:['4.','Nova hid≈æretska godina','3.','Mevlud','5.','Ramazanski bajram'],correct:['4.','Nova hid≈æretska godina'],explanation:'Mubarek-dana ima 4, prvi je Nova hid≈æretska godina.'},
            {type:'dragDrop',question:'Dopuni mjesece:',template:['Treƒái mjesec je','DROP','a deveti je','DROP'],words:['Rebiul-evvel','Ramazan','Safer','≈†evval'],correct:['Rebiul-evvel','Ramazan'],explanation:'Treƒái mjesec: Rebiul-evvel, deveti: Ramazan.'},
            {type:'dragDrop',question:'Dopuni dan hid≈æretskog kalendara:',template:['Prvi dan sedmice je','DROP','Dan poƒçinje od','DROP','sunca'],words:['petak.','zalaska','subota.','izlaska'],correct:['petak.','zalaska'],explanation:'Prvi dan petak, dan poƒçinje od zalaska sunca.'},
            {type:'dragDrop',question:'Dopuni tekbirje:',template:['Allahu ekber, Allahu ekber, La ilahe','DROP','vallahu ekber, ve','DROP'],words:['illallahu','lillahil-hamd','elallahu','subhanallah'],correct:['illallahu','lillahil-hamd'],explanation:'Tekbirje: ...La ilahe illallahu vallahu ekber, ve lillahil-hamd.'},
            {type:'dragDrop',question:'Dopuni Allahu rabbi:',template:['Allahu','DROP','ve Muhammeden','DROP'],words:['rabbi','nebijji','ilahi','resulullah'],correct:['rabbi','nebijji'],explanation:'Allahu rabbi ve Muhammeden nebijji...'}
            ]
        };
    </script>

    <!-- Advanced JavaScript Engine -->
    <script src="../core/quiz-engine-advanced.js"></script>
    <!-- MEKTEB AUTO-SAVE - Inline integracija -->
    <script>
    console.log('üîå MEKTEB AUTO-SAVE: Uƒçitan!');
    
    // ƒåekaj da se stranica potpuno uƒçita
    window.addEventListener('load', function() {
        console.log('üìÑ Stranica uƒçitana, aktiviram auto-save...');
        
        // Funkcija za spremanje rezultata
        async function saveMektebResult(score, total, time) {
            const API_URL = 'https://mekteb.net/wp-json/mekteb/v1';
            
            console.log('üíæ saveMektebResult pozvan:', {score, total, time});
            
            // Provjeri da li je korisnik prijavljen
            const userData = localStorage.getItem('mektebUser');
            if (!userData) {
                console.log('‚ö†Ô∏è Korisnik nije prijavljen - preskaƒçem spremanje');
                return false;
            }
            
            let user;
            try {
                user = JSON.parse(userData);
                console.log('üë§ Prijavljen korisnik:', user.name, '(ID:', user.id + ')');
            } catch (e) {
                console.error('‚ùå Gre≈°ka pri parsiranju user podataka:', e);
                return false;
            }
            
            // Detektuj naziv kviza iz URL-a
            const quizName = window.location.pathname.match(/\/([^\/]+)\.html$/)?.[1]?.toUpperCase() || 'UNKNOWN';
            console.log('üìù Kviz:', quizName);
            
            const payload = {
                user_id: user.id,
                quiz: quizName,
                score: score,
                total: total,
                time: time || 0
            };
            
            console.log('üì§ ≈†aljem na API:', payload);
            
            try {
                const response = await fetch(API_URL + '/save', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });
                
                console.log('üì• API Response Status:', response.status);
                
                const data = await response.json();
                console.log('üì¶ API Response Data:', data);
                
                if (data.success) {
                    console.log('‚úÖ REZULTAT USPJE≈†NO SPREMLJEN!');
                    console.log('   User:', user.name);
                    console.log('   Kviz:', quizName);
                    console.log('   Rezultat:', score + '/' + total);
                    console.log('   Postotak:', Math.round((score/total)*100) + '%');
                    return true;
                } else {
                    console.error('‚ùå API vratio gre≈°ku:', data.message);
                    return false;
                }
            } catch (error) {
                console.error('üî• Gre≈°ka pri slanju na API:', error);
                return false;
            }
        }
        
        // Javna funkcija za ruƒçno spremanje
        window.mektebSave = saveMektebResult;
        
        // AUTOMATSKO DETEKTOVANJE REZULTATA
        let resultSaved = false;
        let lastSeenScore = '0/20';
        
        const observer = new MutationObserver(function(mutations) {
            const resultScreen = document.getElementById('resultScreen');
            const resultScore = document.getElementById('resultScore');
            
            if (resultScreen && resultScore && 
                resultScreen.style.display !== 'none' && 
                !resultSaved) {
                
                const scoreText = resultScore.textContent;
                
                // Ako se rezultat promijenio i nije 0/20
                if (scoreText !== lastSeenScore && scoreText !== '0/20') {
                    console.log('üéØ Rezultat se promijenio:', lastSeenScore, '‚Üí', scoreText);
                    
                    const match = scoreText.match(/(\d+)\/(\d+)/);
                    if (match) {
                        const score = parseInt(match[1]);
                        const total = parseInt(match[2]);
                        
                        // Validacija: score mora biti > 0 ili ako je stvarno 0 onda total > 0
                        if (score > 0 || (score === 0 && total > 0 && scoreText !== '0/20')) {
                            console.log('‚úÖ Detektovan finalni rezultat:', score + '/' + total);
                            
                            resultSaved = true;
                            saveMektebResult(score, total, 0);
                        }
                    }
                }
                
                lastSeenScore = scoreText;
            }
        });
        
        // Posmatraj cijeli body
        observer.observe(document.body, {
            childList: true,
            subtree: true,
            attributes: true,
            attributeFilter: ['style'],
            characterData: true  // Prati promjene u tekstualnom sadr≈æaju
        });
        
        console.log('‚úÖ Auto-save modul aktivan!');
        console.log('   üìå Za ruƒçno spremanje: window.mektebSave(score, total, time)');
    });
    </script>
</body>
</html>