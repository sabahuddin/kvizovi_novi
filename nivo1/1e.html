<!DOCTYPE html>
<html lang="bs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kviz 1E</title>
    
    <!-- Centralizovani CSS -->
    <link rel="stylesheet" href="../core/styles.css">
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="quiz-header">
            <img src="../assets/images/mekteb_logo.png" alt="MEKTEB Logo" class="quiz-icon">
            <h1>Kviz 1E</h1>
            <p class="subtitle">Sure i Dove</p>
        </div>

        <!-- QUIZ SCREEN -->
        <div id="quizScreen" class="quiz-screen">
            <div class="progress-info">
                <a href="../index.html" class="back-link">â† Nazad</a>
                <div class="progress-bar-container">
                    <div id="progressBar" class="progress-bar"></div>
                </div>
                <span id="questionCounter" style="color: #fbbf24; font-weight: 600;">1/20</span>
            </div>

            <div class="question-card">
                <div id="questionText" class="question-text"></div>
                <div id="optionsContainer" class="options"></div>
            </div>
        </div>

        <!-- RESULT SCREEN -->
        <div id="resultScreen" class="result-screen">
            <div class="result-card">
                <div id="resultEmoji" class="result-emoji">ğŸŒŸ</div>
                <div id="resultMessage" class="result-message">Izvrsno!</div>
                <div id="resultScore" class="result-score">0/20</div>
                <div id="resultPercentage" class="result-percentage">0% taÄnih odgovora</div>
                <button onclick="restartQuiz()" class="restart-btn">ğŸ”„ Ponovi kviz</button>
            </div>
        </div>
    </div>

    <!-- POPUP OVERLAY -->
    <div id="popupOverlay" class="popup-overlay">
        <div class="popup-content">
            <div id="popupIcon" class="popup-icon">âœ…</div>
            <div id="popupTitle" class="popup-title">TaÄno!</div>
            <div id="popupExplanation" class="popup-explanation"></div>
            <button onclick="nextQuestion()" class="popup-next-btn">SljedeÄ‡e pitanje â†’</button>
        </div>
    </div>

    <!-- QUIZ DATA -->
    <script>
        const quizData = {
            questionsToShow: 20,
            allQuestions: [

            // ===== DA/NE PITANJA (15) =====
            // Sure
            {question: 'Sura El-Fatiha se naziva "Majka Kur\'ana".', options: ['DA', 'NE'], answer: 'DA', explanation: 'TaÄno! El-Fatiha je prva sura u Kur\'anu i naziva se "Ummul-Kur\'an" (Majka Kur\'ana).'},
            {question: 'Sura El-Fatiha ima 7 ajeta.', options: ['DA', 'NE'], answer: 'DA', explanation: 'TaÄno! El-Fatiha ima 7 ajeta i uÄi se na svakom rekatu namaza.'},
            {question: 'Sura En-Nasr je objavljena u Medini.', options: ['DA', 'NE'], answer: 'DA', explanation: 'TaÄno! En-Nasr (PomoÄ‡) je medinska sura i jedna od posljednjih objavljenih sura.'},
            {question: 'Sura El-Leheb govori o Ebu Lehebu i njegovoj Å¾eni.', options: ['DA', 'NE'], answer: 'DA', explanation: 'TaÄno! El-Leheb (Plamen) govori o Ebu Lehebu koji je bio neprijatelj islama.'},
            {question: 'Sura El-Ihlas govori o Allahovom jedinstvu.', options: ['DA', 'NE'], answer: 'DA', explanation: 'TaÄno! El-Ihlas opisuje Allahovo jedinstvo - "Kul huvallahu ehad" (Reci: On je Allah Jedan).'},
            {question: 'Sura El-Ihlas vrijedi kao treÄ‡ina Kur\'ana.', options: ['DA', 'NE'], answer: 'DA', explanation: 'TaÄno! Muhammed, a.s., je rekao da sura El-Ihlas vrijedi kao treÄ‡ina Kur\'ana.'},
            {question: 'Sura En-Nas je 114. i posljednja sura u Kur\'anu.', options: ['DA', 'NE'], answer: 'DA', explanation: 'TaÄno! En-Nas (Ljudi) je 114. i posljednja sura u Kur\'anu.'},
            {question: 'El-Felek i En-Nas su poznate kao "zaÅ¡titnice" (mu\'avvizetejn).', options: ['DA', 'NE'], answer: 'DA', explanation: 'TaÄno! El-Felek i En-Nas su sure zaÅ¡titnice od zla.'},
            // Dove
            {question: 'Subhaneke se uÄi na poÄetku svakog namaza.', options: ['DA', 'NE'], answer: 'DA', explanation: 'TaÄno! Subhaneke je dova kojom veliÄamo Allaha, a uÄimo je na poÄetku namaza nakon iftitahi-tekbira.'},
            {question: 'Et-Tehijjatu su rijeÄi iz razgovora na MiradÅ¾u.', options: ['DA', 'NE'], answer: 'DA', explanation: 'TaÄno! Et-Tehijjatu su rijeÄi razmijenjene izmeÄ‘u Allaha i Poslanika na MiradÅ¾u.'},
            {question: 'Salavati su blagoslovi na Poslanika, a.s.', options: ['DA', 'NE'], answer: 'DA', explanation: 'TaÄno! Salavati su blagoslovi koje uÄimo na Poslanika, a.s., poslije Et-Tehijjatu.'},
            {question: 'Ajetul-kursijj je najvredniji ajet u Kur\'anu.', options: ['DA', 'NE'], answer: 'DA', explanation: 'TaÄno! Ajetul-kursijj (255. ajet sure El-Bekare) je najvredniji ajet u Kur\'anu.'},
            {question: 'Ajetul-kursijj se nalazi u suri El-Bekare.', options: ['DA', 'NE'], answer: 'DA', explanation: 'TaÄno! Ajetul-kursijj je 255. ajet sure El-Bekare.'},
            {question: 'Poslije ezana uÄimo dovu za Poslanika, a.s.', options: ['DA', 'NE'], answer: 'DA', explanation: 'TaÄno! Poslije ezana uÄimo dovu u kojoj molimo Allaha da podari Poslaniku vesile i fadile.'},
            {question: 'Zikr poslije namaza ukljuÄuje tesbih, tahmid i tekbir.', options: ['DA', 'NE'], answer: 'DA', explanation: 'TaÄno! Poslije namaza uÄimo: 33x Subhanallah, 33x Elhamdulillah, 33x Allahu ekber.'},

            // ===== VIÅ ESTRUKI IZBOR - SURE (15) =====
            {question: 'Koliko ajeta ima sura El-Fatiha?', options: ['5', '6', '7', '8'], answer: '7', explanation: 'El-Fatiha ima 7 ajeta i zove se "Majka Kur\'ana".'},
            {question: 'Koja je prva sura u Kur\'anu?', options: ['El-Ihlas', 'El-Fatiha', 'El-Bekare', 'En-Nas'], answer: 'El-Fatiha', explanation: 'El-Fatiha je prva sura u Kur\'anu.'},
            {question: 'Koja je posljednja sura u Kur\'anu?', options: ['El-Felek', 'El-Ihlas', 'En-Nas', 'El-Kevser'], answer: 'En-Nas', explanation: 'En-Nas je 114. i posljednja sura u Kur\'anu.'},
            {question: 'Koja sura je 113. u Kur\'anu?', options: ['El-Ihlas', 'El-Felek', 'En-Nas', 'El-Leheb'], answer: 'El-Felek', explanation: 'El-Felek je 113. sura u Kur\'anu.'},
            {question: 'Koliko ajeta ima sura El-Ihlas?', options: ['3', '4', '5', '6'], answer: '4', explanation: 'Sura El-Ihlas ima 4 ajeta.'},
            {question: 'Koliko ajeta ima sura En-Nasr?', options: ['3', '4', '5', '6'], answer: '3', explanation: 'Sura En-Nasr (PomoÄ‡) ima 3 ajeta.'},
            {question: 'Koliko ajeta ima sura El-Leheb?', options: ['3', '4', '5', '6'], answer: '5', explanation: 'Sura El-Leheb (Plamen) ima 5 ajeta.'},
            {question: 'O kome govori sura El-Leheb?', options: ['Ebu Talibu', 'Ebu Lehebu', 'Ebu Bekru', 'Ebu Hurejri'], answer: 'Ebu Lehebu', explanation: 'El-Leheb govori o Ebu Lehebu i njegovoj Å¾eni koji su bili neprijatelji islama.'},
            {question: 'Å ta znaÄi "En-Nasr"?', options: ['Ljudi', 'PomoÄ‡', 'Zora', 'Plamen'], answer: 'PomoÄ‡', explanation: 'En-Nasr znaÄi "PomoÄ‡" - sura govori o Allahovoj pomoÄ‡i i pobjedi.'},
            {question: 'Å ta znaÄi "El-Felek"?', options: ['Ljudi', 'Jedinstvo', 'Zora/Svitanje', 'Plamen'], answer: 'Zora/Svitanje', explanation: 'El-Felek znaÄi "Zora" ili "Svitanje" - traÅ¾imo zaÅ¡titu Gospodara zore.'},
            {question: 'Å ta znaÄi "En-Nas"?', options: ['Zora', 'Jedinstvo', 'Ljudi', 'PomoÄ‡'], answer: 'Ljudi', explanation: 'En-Nas znaÄi "Ljudi" - traÅ¾imo zaÅ¡titu Gospodara ljudi.'},
            {question: 'Å ta znaÄi "El-Ihlas"?', options: ['PomoÄ‡', 'Iskrenost/ÄŒistoÄ‡a', 'Zora', 'Plamen'], answer: 'Iskrenost/ÄŒistoÄ‡a', explanation: 'El-Ihlas znaÄi "Iskrenost" ili "ÄŒistoÄ‡a vjere" - govori o Äistom vjerovanju u Allaha.'},
            {question: '"Kul huvallahu ehad" je poÄetak koje sure?', options: ['El-Fatiha', 'El-Ihlas', 'El-Felek', 'En-Nas'], answer: 'El-Ihlas', explanation: '"Kul huvallahu ehad" (Reci: On je Allah Jedan) je poÄetak sure El-Ihlas.'},
            {question: '"Iza dÅ¾ae nasrullahi vel-feth" je poÄetak koje sure?', options: ['El-Ihlas', 'En-Nasr', 'El-Felek', 'El-Leheb'], answer: 'En-Nasr', explanation: '"Iza dÅ¾ae nasrullahi vel-feth" (Kada doÄ‘e Allahova pomoÄ‡ i pobjeda) je poÄetak sure En-Nasr.'},
            {question: '"Tebbet jeda Ebi Lehebin ve tebb" je poÄetak koje sure?', options: ['En-Nasr', 'El-Ihlas', 'El-Leheb', 'El-Felek'], answer: 'El-Leheb', explanation: '"Tebbet jeda Ebi Lehebin ve tebb" (Propale ruke Ebu Lehebove) je poÄetak sure El-Leheb.'},

            // ===== VIÅ ESTRUKI IZBOR - DOVE (15) =====
            {question: 'Kada se uÄi Subhaneke?', options: ['Na ruku\'u', 'Na sedÅ¾di', 'Na poÄetku namaza', 'Na kraju namaza'], answer: 'Na poÄetku namaza', explanation: 'Subhaneke se uÄi na poÄetku namaza, nakon iftitahi-tekbira.'},
            {question: 'Na sjedenju u namazu uÄimo:', options: ['Subhaneke', 'Et-Tehijjatu', 'Ajetul-kursijj', 'Dovu poslije ezana'], answer: 'Et-Tehijjatu', explanation: 'Na sjedenju u namazu uÄimo Et-Tehijjatu, salavate i dove.'},
            {question: 'Salavati se uÄe:', options: ['Na poÄetku namaza', 'Poslije Et-Tehijjatu', 'Poslije ezana', 'Prije spavanja'], answer: 'Poslije Et-Tehijjatu', explanation: 'Salavati se uÄe poslije Et-Tehijjatu na sjedenju u namazu.'},
            {question: 'Ajetul-kursijj je:', options: ['Cijela sura', '255. ajet sure El-Bekare', 'Dova poslije namaza', 'PoÄetak El-Fatihe'], answer: '255. ajet sure El-Bekare', explanation: 'Ajetul-kursijj je 255. ajet sure El-Bekare, najvredniji ajet u Kur\'anu.'},
            {question: 'Kada se uÄi Ajetul-kursijj?', options: ['Samo u namazu', 'Poslije svakog farza', 'Samo ujutro', 'Samo naveÄer'], answer: 'Poslije svakog farza', explanation: 'Ajetul-kursijj se preporuÄuje uÄiti poslije svakog farz-namaza, prije spavanja i u drugim prilikama.'},
            {question: 'Zikr poslije namaza ukljuÄuje uÄenje:', options: ['Samo Subhanallah', 'Samo Elhamdulillah', 'Tesbih, tahmid i tekbir', 'Samo Ajetul-kursijj'], answer: 'Tesbih, tahmid i tekbir', explanation: 'Zikr poslije namaza: 33x Subhanallah (tesbih), 33x Elhamdulillah (tahmid), 33x Allahu ekber (tekbir).'},
            {question: 'Koliko puta se uÄi Subhanallah u zikru poslije namaza?', options: ['10', '11', '33', '99'], answer: '33', explanation: 'Subhanallah se uÄi 33 puta u zikru poslije namaza.'},
            {question: 'Koliko puta se uÄi Elhamdulillah u zikru poslije namaza?', options: ['10', '11', '33', '99'], answer: '33', explanation: 'Elhamdulillah se uÄi 33 puta u zikru poslije namaza.'},
            {question: 'Koliko puta se uÄi Allahu ekber u zikru poslije namaza?', options: ['10', '11', '33', '99'], answer: '33', explanation: 'Allahu ekber se uÄi 33 puta u zikru poslije namaza.'},
            {question: 'U dovi poslije ezana molimo za Poslanika:', options: ['Oprost', 'Vesile i fadile', 'Zdravlje', 'Imetak'], answer: 'Vesile i fadile', explanation: 'U dovi poslije ezana molimo Allaha da Poslaniku podari vesile (stepen u DÅ¾ennetu) i fadile (poÄast).'},
            {question: 'Redoslijed uÄenja na sjedenju je:', options: ['Salavati, Et-Tehijjatu, Dove', 'Et-Tehijjatu, Salavati, Dove', 'Dove, Et-Tehijjatu, Salavati', 'Subhaneke, Salavati, Dove'], answer: 'Et-Tehijjatu, Salavati, Dove', explanation: 'Na sjedenju uÄimo redom: Et-Tehijjatu, Salavate, pa Dove.'},
            {question: 'Å ta znaÄi "Subhaneke"?', options: ['Hvala Allahu', 'Slavljen neka si Ti, Allahu', 'Allah je najveÄ‡i', 'U ime Allaha'], answer: 'Slavljen neka si Ti, Allahu', explanation: 'Subhaneke znaÄi "Slavljen neka si Ti, Allahu" - dova veliÄanja na poÄetku namaza.'},
            {question: 'Et-Tehijjatu poÄinje rijeÄima:', options: ['Subhaneke', 'Ettehijjatu lillahi', 'Allahumme salli', 'Rabbena atina'], answer: 'Ettehijjatu lillahi', explanation: 'Et-Tehijjatu poÄinje sa "Ettehijjatu lillahi ves-salavatu vet-tajjibatu".'},
            {question: 'Salavati poÄinju rijeÄima:', options: ['Subhaneke', 'Ettehijjatu', 'Allahumme salli ala Muhammed', 'Rabbena atina'], answer: 'Allahumme salli ala Muhammed', explanation: 'Salavati poÄinju sa "Allahumme salli ala Muhammedin..." - blagoslov na Poslanika.'},
            {question: 'Dova "Rabbena atina fid-dunja haseneten..." se uÄi:', options: ['Na poÄetku namaza', 'Prije Et-Tehijjatu', 'Poslije salavata', 'Poslije ezana'], answer: 'Poslije salavata', explanation: 'Dova "Rabbena atina..." se uÄi poslije salavata, na kraju sjedenja prije selama.'},

            // ===== PAMETNA PITANJA (15) =====
            // Izbaci uljeza (4)
            {question: 'IZBACI ULJEZA: El-Fatiha, En-Nasr, El-Bekare, El-Ihlas', options: ['El-Fatiha', 'En-Nasr', 'El-Bekare', 'El-Ihlas'], answer: 'El-Bekare', explanation: 'El-Fatiha, En-Nasr i El-Ihlas su KRATKE sure, a El-Bekare je NAJDUÅ½A sura u Kur\'anu.'},
            {question: 'IZBACI ULJEZA: Subhaneke, Et-Tehijjatu, Ajetul-kursijj, Salavati', options: ['Subhaneke', 'Et-Tehijjatu', 'Ajetul-kursijj', 'Salavati'], answer: 'Ajetul-kursijj', explanation: 'Subhaneke, Et-Tehijjatu i Salavati su NAMASKE dove u toku namaza, a Ajetul-kursijj je AJET iz Kur\'ana.'},
            {question: 'IZBACI ULJEZA: El-Felek, En-Nas, El-Ihlas, El-Leheb', options: ['El-Felek', 'En-Nas', 'El-Ihlas', 'El-Leheb'], answer: 'El-Leheb', explanation: 'El-Felek, En-Nas i El-Ihlas su sure koje se Äesto uÄe zajedno (tri Kul), a El-Leheb nije meÄ‘u njima.'},
            {question: 'IZBACI ULJEZA: Subhanallah, Elhamdulillah, Estagfirullah, Allahu ekber', options: ['Subhanallah', 'Elhamdulillah', 'Estagfirullah', 'Allahu ekber'], answer: 'Estagfirullah', explanation: 'Subhanallah, Elhamdulillah i Allahu ekber su ZIKR POSLIJE NAMAZA (33x svaki), a Estagfirullah nije dio tog zikra.'},

            // Asocijacije (4)
            {question: 'Broj 7 vas asocira na:', options: ['Ajete El-Ihlas', 'Ajete El-Fatihe', 'Ajete En-Nasr', 'Ajete El-Leheb'], answer: 'Ajete El-Fatihe', explanation: 'Sura El-Fatiha ima 7 ajeta.'},
            {question: 'Broj 33 vas asocira na:', options: ['Broj sura', 'Zikr poslije namaza', 'Broj ajeta El-Bekare', 'Broj poslanika'], answer: 'Zikr poslije namaza', explanation: 'U zikru poslije namaza uÄimo 33x Subhanallah, 33x Elhamdulillah, 33x Allahu ekber.'},
            {question: 'RijeÄ "MiradÅ¾" vas asocira na:', options: ['Subhaneke', 'Et-Tehijjatu', 'Salavate', 'Ajetul-kursijj'], answer: 'Et-Tehijjatu', explanation: 'Et-Tehijjatu su rijeÄi iz razgovora Allaha i Poslanika na MiradÅ¾u.'},
            {question: 'RijeÄ "zaÅ¡titnice" vas asocira na:', options: ['El-Fatiha i El-Ihlas', 'El-Felek i En-Nas', 'En-Nasr i El-Leheb', 'Subhaneke i Salavati'], answer: 'El-Felek i En-Nas', explanation: 'El-Felek i En-Nas su sure zaÅ¡titnice (mu\'avvizetejn).'},

            // Analogije (4)
            {question: 'DOPUNI: El-Felek : 113 = En-Nas : ?', options: ['110', '112', '114', '115'], answer: '114', explanation: 'El-Felek je 113. sura, a En-Nas je 114. sura.'},
            {question: 'DOPUNI: El-Fatiha : 7 ajeta = El-Ihlas : ?', options: ['3 ajeta', '4 ajeta', '5 ajeta', '6 ajeta'], answer: '4 ajeta', explanation: 'El-Fatiha ima 7 ajeta, a El-Ihlas ima 4 ajeta.'},
            {question: 'DOPUNI: Et-Tehijjatu : sjedenje = Subhaneke : ?', options: ['SedÅ¾da', 'Ruku\'', 'PoÄetak namaza', 'Kraj namaza'], answer: 'PoÄetak namaza', explanation: 'Et-Tehijjatu uÄimo na sjedenju, a Subhaneke na poÄetku namaza.'},
            {question: 'DOPUNI: Subhanallah : tesbih = Elhamdulillah : ?', options: ['Tekbir', 'Tahmid', 'Tehlil', 'Temhid'], answer: 'Tahmid', explanation: 'Subhanallah je tesbih (slavljenje), a Elhamdulillah je tahmid (zahvala).'},

            // Ko sam ja (3)
            {question: '"Ja sam prva sura. Imam 7 ajeta. Zovem se Majka Kur\'ana." Koja sam sura?', options: ['El-Ihlas', 'El-Fatiha', 'El-Bekare', 'En-Nas'], answer: 'El-Fatiha', explanation: 'El-FATIHA je prva sura, ima 7 ajeta i zove se "Majka Kur\'ana".'},
            {question: '"Ja sam 255. ajet El-Bekare. Ja sam najvredniji ajet." Å ta sam?', options: ['Subhaneke', 'Et-Tehijjatu', 'Ajetul-kursijj', 'Salavati'], answer: 'Ajetul-kursijj', explanation: 'AJETUL-KURSIJJ je 255. ajet sure El-Bekare i najvredniji ajet u Kur\'anu.'},
            {question: '"Ja sam dova na sjedenju. Spominjem MiradÅ¾." Å ta sam?', options: ['Subhaneke', 'Et-Tehijjatu', 'Salavati', 'Ajetul-kursijj'], answer: 'Et-Tehijjatu', explanation: 'ET-TEHIJJATU su rijeÄi razmijenjene na MiradÅ¾u i uÄe se na sjedenju u namazu.'}
                    ]
        };
    </script>

    <!-- Centralizovani JavaScript Engine -->
    <script src="../core/quiz-engine.js"></script>
    <!-- MEKTEB AUTO-SAVE - Inline integracija -->
    <script>
    console.log('ğŸ”Œ MEKTEB AUTO-SAVE: UÄitan!');
    
    // ÄŒekaj da se stranica potpuno uÄita
    window.addEventListener('load', function() {
        console.log('ğŸ“„ Stranica uÄitana, aktiviram auto-save...');
        
        // Funkcija za spremanje rezultata
        async function saveMektebResult(score, total, time) {
            const API_URL = 'https://mekteb.net/wp-json/mekteb/v1';
            
            console.log('ğŸ’¾ saveMektebResult pozvan:', {score, total, time});
            
            // Provjeri da li je korisnik prijavljen
            const userData = localStorage.getItem('mektebUser');
            if (!userData) {
                console.log('âš ï¸ Korisnik nije prijavljen - preskaÄem spremanje');
                return false;
            }
            
            let user;
            try {
                user = JSON.parse(userData);
                console.log('ğŸ‘¤ Prijavljen korisnik:', user.name, '(ID:', user.id + ')');
            } catch (e) {
                console.error('âŒ GreÅ¡ka pri parsiranju user podataka:', e);
                return false;
            }
            
            // Detektuj naziv kviza iz URL-a
            const quizName = window.location.pathname.match(/\/([^\/]+)\.html$/)?.[1]?.toUpperCase() || 'UNKNOWN';
            console.log('ğŸ“ Kviz:', quizName);
            
            const payload = {
                user_id: user.id,
                quiz: quizName,
                score: score,
                total: total,
                time: time || 0
            };
            
            console.log('ğŸ“¤ Å aljem na API:', payload);
            
            try {
                const response = await fetch(API_URL + '/save', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });
                
                console.log('ğŸ“¥ API Response Status:', response.status);
                
                const data = await response.json();
                console.log('ğŸ“¦ API Response Data:', data);
                
                if (data.success) {
                    console.log('âœ… REZULTAT USPJEÅ NO SPREMLJEN!');
                    console.log('   User:', user.name);
                    console.log('   Kviz:', quizName);
                    console.log('   Rezultat:', score + '/' + total);
                    console.log('   Postotak:', Math.round((score/total)*100) + '%');
                    return true;
                } else {
                    console.error('âŒ API vratio greÅ¡ku:', data.message);
                    return false;
                }
            } catch (error) {
                console.error('ğŸ”¥ GreÅ¡ka pri slanju na API:', error);
                return false;
            }
        }
        
        // Javna funkcija za ruÄno spremanje
        window.mektebSave = saveMektebResult;
        
        // AUTOMATSKO DETEKTOVANJE REZULTATA
        let resultSaved = false;
        let lastSeenScore = '0/20';
        
        const observer = new MutationObserver(function(mutations) {
            const resultScreen = document.getElementById('resultScreen');
            const resultScore = document.getElementById('resultScore');
            
            if (resultScreen && resultScore && 
                resultScreen.style.display !== 'none' && 
                !resultSaved) {
                
                const scoreText = resultScore.textContent;
                
                // Ako se rezultat promijenio i nije 0/20
                if (scoreText !== lastSeenScore && scoreText !== '0/20') {
                    console.log('ğŸ¯ Rezultat se promijenio:', lastSeenScore, 'â†’', scoreText);
                    
                    const match = scoreText.match(/(\d+)\/(\d+)/);
                    if (match) {
                        const score = parseInt(match[1]);
                        const total = parseInt(match[2]);
                        
                        // Validacija: score mora biti > 0 ili ako je stvarno 0 onda total > 0
                        if (score > 0 || (score === 0 && total > 0 && scoreText !== '0/20')) {
                            console.log('âœ… Detektovan finalni rezultat:', score + '/' + total);
                            
                            resultSaved = true;
                            saveMektebResult(score, total, 0);
                        }
                    }
                }
                
                lastSeenScore = scoreText;
            }
        });
        
        // Posmatraj cijeli body
        observer.observe(document.body, {
            childList: true,
            subtree: true,
            attributes: true,
            attributeFilter: ['style'],
            characterData: true  // Prati promjene u tekstualnom sadrÅ¾aju
        });
        
        console.log('âœ… Auto-save modul aktivan!');
        console.log('   ğŸ“Œ Za ruÄno spremanje: window.mektebSave(score, total, time)');
    });
    </script>
</body>
</html>
